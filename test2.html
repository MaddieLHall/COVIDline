<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Colorado COVID Deaths</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <style type="text/css">
      .line {
        fill: none;
        stroke: black;
        stroke-width: 1;
      }
    </style>
  </head>
  <body>
    <button type="button" id="cases">Cases</button>
    <button type="button" id="test">Test</button>
    <button type="button" id="test">Test</button>
    <button type="button" id="test">Test</button>

    <div id= "graphbody">
    <script type="text/javascript">
      //Width and height of container
      let w = 800;
      let h = 300;
      let padding = 40;

      let parseDate = d3.timeParse("%m/%d/%Y");

      let rowConverter = function (d) {
        return {
          Cases: parseInt(d.Cases),
          Counties: parseInt(d.Counties),
          Date: parseDate(d.Date),
          Death: parseInt(d.Deaths),
          Hosp: parseInt(d.Hosp),
          Index: parseInt(d.Index),
          Tested: parseInt(d.Tested),
        };
      };
      let dataset, xScale, yScale, xAxis, yAxis, line; //Empty, for now

      //loading data
      d3.csv("COVIDco.csv", rowConverter, function (data) {
        dataset = data;
        console.log(dataset);

        //setting scales
        xScale = d3
          .scaleTime()
          .domain([
            d3.min(dataset, function (d) {
              return d.Date;
            }),
            d3.max(dataset, function (d) {
              return d.Date;
            }),
          ])
          .range([padding, w]);

        yScale = d3
          .scaleLinear()
          .domain([
            0,
            d3.max(dataset, function (d) {
              return d.Death;
            }),
          ])
          .range([h - padding, 15]); //15 is so top of axis is not cut off

        //Define axes
        xAxis = d3
          .axisBottom()
          .scale(xScale)
          .ticks(10)
          .tickFormat(d3.timeFormat("%m-%d-%Y"));
        //Define Y axis
        yAxis = d3.axisLeft().scale(yScale).ticks(10);

        //Define line generator
        line = d3
          .line()
          .x(function (d) {
            return xScale(d.Date);
          })
          .y(function (d) {
            return yScale(d.Death);
          });

        let caseLine = d3
          .line()
          .x(function (d) {
            return xScale(d.Date);
          })
          .y(function (d) {
            return yScale(d.Cases);
          });

        //Create SVG element
        let svg = d3
          .select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h);

        //Create line
        // svg
        //   .append("path")
        //   .attr("class", "line")
        //   .attr("d", line(dataset));

        //   svg.append("path")
        // .data([dataset])
        // .attr("class", "line")
        // .attr("d", line);

        svg
          .selectAll("path")
          .data([dataset])
          .enter()
          .append("path")
          .attr("class", "line")
          .attr("d", line);

        //Create axes
        svg
          .append("g")
          .attr("class", "axis")
          .attr("transform", "translate(0," + (h - padding) + ")")
          .call(xAxis);

        svg
          .append("g")
          .attr("class", "axis")
          .attr("transform", "translate(" + padding + ",0)")
          .call(yAxis);



        // ON CASES BUTTON CLICK
        
          d3.select("button#Cases").on("click", function () {

              svg.selectAll("path")
              .data([dataset])
              .transition()
				    	.duration(1000)
              .enter()
              .append("path")
              .attr("class", "line")
              .attr("d", caseLine);

					    




          // Select the section we want to apply our changes to
    // let svg = d3.select("body").transition();

// Make the changes
//     svg.select(".line")   // change the line
//         .duration(750)
//         .attr("d", line(dataset));
//     svg.select(".x.axis") // change the x axis
//         .duration(750)
//         .call(xScale);
//     svg.select(".y.axis") // change the y axis
//         .duration(750)
//         .call(yScale);

// });


        }); // close onclick

      });

       // close /dataset

       

    </script>
    </div>
  </body>
</html>
